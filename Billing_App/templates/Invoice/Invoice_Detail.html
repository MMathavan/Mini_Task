{% extends 'base.html' %}

{% block content %}
<h3 class="mb-4">Billing Page</h3>

<div class="row mb-3">
    <div class="col-md-4"><strong>Invoice No:</strong> {{ invoice.INVOICEID }}</div>
    <div class="col-md-4"><strong>Customer Name:</strong> {{ invoice.CUSTNAME }}</div>
    <div class="col-md-4"><strong>Customer Email:</strong> {{ invoice.CUSTEMAIL }}</div>
</div>

<h5 class="mb-2">Bill Section</h5>
<div class="table-responsive mb-4">
    <table class="table table-bordered table-sm align-middle">
        <thead>
            <tr>
                <th>Product ID</th>
                <th>Product Name</th>
                <th>Unit Price</th>
                <th>Quantity</th>
                <th>Purchase Price</th>
                <th>Tax %</th>
                <th>Tax Amount</th>
                <th>Total</th>
            </tr>
        </thead>
        <tbody>
            {% for item in items %}
                <tr>
                    <td>{{ item.PRODUCT.PRODCODE }}</td>
                    <td>{{ item.PRODUCT.PRODNAME }}</td>
                    <td>{{ item.UNITPRICE }}</td>
                    <td>{{ item.QTY }}</td>
                    <td>{{ item.LINESUBTOTAL }}</td>
                    <td>{{ item.TAXPERCENT }}</td>
                    <td>{{ item.LINETAX }}</td>
                    <td>{{ item.LINETOTAL }}</td>
                </tr>
            {% endfor %}
        </tbody>
    </table>
</div>

<div class="mb-4 text-end">
    <div><strong>Total price without tax:</strong> {{ invoice.GROSSAMT }}</div>
    <div><strong>Total tax payable:</strong> {{ invoice.TAXAMT }}</div>
    <div><strong>Net price of purchased items:</strong> {{ invoice.NETAMT }}</div>
    <div><strong>Rounded down payable:</strong> {{ invoice.ROUNDEDPAYABLE }}</div>
    <div><strong>Balance payable to customer:</strong> {{ invoice.BALANCEAMT }}</div>
</div>

<hr>
<h5 class="mb-2">Balance Denomination</h5>
<div class="row">
    <div class="col-md-4 offset-md-8">
        <table class="table table-sm table-bordered">
            <thead>
                <tr>
                    <th>Value</th>
                    <th>Count</th>
                </tr>
            </thead>
            <tbody>
                {% for value, count in invoice.CHANGE_DENOMS.items %}
                    <tr>
                        <td>{{ value }}</td>
                        <td>{{ count }}</td>
                    </tr>
                {% empty %}
                    <tr>
                        <td colspan="2" class="text-center">No balance denomination.</td>
                    </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>

<div class="text-end">
    <a href="{% url 'invoice_index' %}" class="btn btn-secondary btn-sm">Back</a>
</div>
{% endblock %}
